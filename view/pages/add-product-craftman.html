<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Artisan – Ajouter un produit</title>
    <link rel="stylesheet" href="../../assets/css/pages/add-product-craftman.css">
</head>
<body>

<div class="container">

    <header class="header">
        <h1>Ajouter un nouveau produit</h1>
        <a class="btn-outline" href="javascript:history.back()">← Retour</a>
    </header>

    <form class="form" id="productForm" enctype="multipart/form-data">

        <div class="field">
            <label for="title">Nom du produit</label>
            <input id="title" type="text" placeholder="Ex : Bol en céramique">
        </div>

        <div class="row">
            <div class="field">
                <label for="price">Prix (€)</label>
                <input id="price" type="number" step="0.01" min="0.01">
            </div>
            <div class="field">
                <label for="stock">Stock</label>
                <input id="stock" type="number" min="0">
            </div>
        </div>

        <div class="field">
            <label for="category">Catégorie</label>
            <select id="category">
                <option value="" disabled selected>— Choisissez une catégorie —</option>
                <option>Poterie</option>
                <option>Décoration</option>
                <option>Vêtements</option>
                <option>Accessoires</option>
            </select>
        </div>

        <div class="field">
            <label for="description">Description</label>
            <textarea id="description" rows="5" placeholder="Décris ton produit..."></textarea>
        </div>

        <div class="field">
            <label for="images">Images (3 à 6)</label>
            <input id="images" type="file" multiple accept="image/jpeg,image/png,image/webp">
            <div id="preview" class="preview"></div>
        </div>

        <div class="actions">
            <button type="submit" class="btn-primary">Envoyer</button>
        </div>

    </form>
</div>

<!-- POPUP -->
<div class="modal-overlay" id="modal">
    <div class="modal">
        <h3>Champs manquants</h3>
        <p id="modalText"></p>
        <button onclick="closeModal()">OK</button>
    </div>
</div>

<script>
    const form = document.getElementById("productForm");
    const imagesInput = document.getElementById("images");
    const preview = document.getElementById("preview");
    const modal = document.getElementById("modal");
    const modalText = document.getElementById("modalText");

    const MIN_IMAGES = 3;
    const MAX_IMAGES = 6;

    function openModal(message) {
        modalText.textContent = message;
        modal.style.display = "flex";
    }

    function closeModal() {
        modal.style.display = "none";
    }

    imagesInput.addEventListener("change", () => {
        preview.innerHTML = "";
        Array.from(imagesInput.files).forEach(file => {
            const img = document.createElement("img");
            img.src = URL.createObjectURL(file);
            preview.appendChild(img);
        });
    });

    form.addEventListener("submit", (e) => {
        e.preventDefault();

        const title = document.getElementById("title").value.trim();
        const price = document.getElementById("price").value.trim();
        const stock = document.getElementById("stock").value.trim();
        const category = document.getElementById("category").value;
        const description = document.getElementById("description").value.trim();
        const imagesCount = imagesInput.files.length;

        if (!title || !price || !stock || !category || !description) {
            openModal("Veuillez compléter tous les champs obligatoires.");
            return;
        }

        if (imagesCount < MIN_IMAGES || imagesCount > MAX_IMAGES) {
            openModal("Veuillez ajouter entre 3 et 6 images.");
            return;
        }

        openModal("✅ Formulaire valide. Prêt à être envoyé !");
    });
</script>

</body>
</html>
